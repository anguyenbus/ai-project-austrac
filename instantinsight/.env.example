# Environment Configuration for MCP Alembic RAG Database
# Copy this file to .env and update with your specific settings

# =============================================================================
# ENVIRONMENT & GENERAL SETTINGS
# =============================================================================

# Application Environment (development/staging/production)
ENVIRONMENT=development
DEBUG=true

# =============================================================================
# DATABASE CONFIGURATION - PostgreSQL (Vector Operations ONLY)
# =============================================================================

# PostgreSQL Connection (for pgvector and RAG operations)
# POSTGRES_HOST=db (if inside dev container)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DATABASE=instantinsight

# PostgreSQL Connection URL (auto-generated from above if not specified)
# DATABASE_URL=postgresql://postgres:postgres@localhost:5432/instantinsight
# DATABASE_URL=postgresql://postgres:postgres@db:5432/instantinsight (if inside dev container)

# PostgreSQL Pool Settings (Production)
POSTGRES_MIN_CONNECTIONS=20
POSTGRES_MAX_CONNECTIONS=100
POSTGRES_POOL_TIMEOUT=30
POSTGRES_STATEMENT_TIMEOUT=60000

# =============================================================================
# ANALYTICS DATABASE CONFIGURATION (Universal)
# =============================================================================

# Universal Analytics Backend URL (Required)
# Supports: Athena, PostgreSQL, Snowflake, BigQuery, DuckDB, etc.
# Format: <backend>://<catalog>?param1=value1&param2=value2

# AWS Athena (Primary):
ANALYTICS_DB_URL=athena://awsdatacatalog?region=ap-southeast-2&database=text_to_sql&work_group=primary&s3_staging_dir=s3://your-bucket/path/

# Alternative Backend Examples:
# PostgreSQL:  ANALYTICS_DB_URL=postgres://user:password@localhost:5432/database
# Snowflake:   ANALYTICS_DB_URL=snowflake://account/database?warehouse=compute
# BigQuery:    ANALYTICS_DB_URL=bigquery://project-id/dataset

# =============================================================================
# AWS CONFIGURATION
# =============================================================================

# AWS Profile & Region (for Athena backend)
AWS_PROFILE=your_aws_profile_name
AWS_REGION=ap-southeast-2
AWS_DEFAULT_REGION=ap-southeast-2

# =============================================================================
# AWS S3 SESSION STORAGE (Multi-turn Conversations)
# =============================================================================

# Session Storage Configuration
USE_S3_SESSION=true
SESSION_BUCKET=instantinsight-session
SESSION_PREFIX=sessions/
SESSION_TTL_DAYS=30

# =============================================================================
# AWS BEDROCK CONFIGURATION (LLM Operations ONLY)
# =============================================================================

# LLM Provider (must be 'bedrock' - no alternatives allowed)
LLM_PROVIDER=bedrock

# Bedrock Model Configuration
BEDROCK_MODEL=apac.anthropic.claude-sonnet-4-20250514-v1:0
BEDROCK_MAX_TOKENS=4000
BEDROCK_TEMPERATURE=0.1

# Bedrock Embedding Configuration (must use Titan)
BEDROCK_EMBEDDING_MODEL=amazon.titan-embed-text-v2:0
EMBEDDING_MODEL=amazon.titan-embed-text-v2:0
EMBEDDING_PROVIDER=bedrock

# =============================================================================
# REDIS CACHE CONFIGURATION
# =============================================================================

# Redis Connection
CACHE_PROVIDER=redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_MAX_CONNECTIONS=1000

# Cache Performance Settings
CACHE_TTL_HOURS=24
CACHE_SIMILARITY_THRESHOLD=0.92
CACHE_MAX_ENTRIES_PER_USER=1000
CACHE_MAX_SIZE=10000
CACHE_ENABLE_METRICS=true
CACHE_INDEX_ALGORITHM=FLAT

# =============================================================================
# RAG SYSTEM CONFIGURATION
# =============================================================================

# Vector Storage (must be pgvector)
VECTORSTORE_TYPE=pgvector
USE_PGVECTOR=true
PGVECTOR_INDEX_TYPE=hnsw

# Document Processing
CHUNK_SIZE=1000
CHUNK_OVERLAP=200

# Conversation & Memory
CONVERSATION_MEMORY=true
MAX_CONVERSATION_HISTORY=10

# Vector Search Settings
MAX_VECTOR_RESULTS=10
FORCE_REBUILD_VECTOR_STORE=false

# Schema Extraction
USE_ATHENA_SCHEMA_ONLY=true
AUTO_EXTRACT_SCHEMA=true

# =============================================================================
# DEPRECATED/REMOVED FEATURES (kept for compatibility)
# =============================================================================

# Neo4j Support Removed - PostgreSQL with pgvector ONLY
KNOWLEDGE_GRAPH_ENABLED=false
ENABLE_KNOWLEDGE_GRAPH=false
AUTO_POPULATE_GRAPH=false
HYBRID_RETRIEVAL_ENABLED=false
VECTOR_WEIGHT=1.0
GRAPH_WEIGHT=0.0
MAX_GRAPH_RESULTS=0

# =============================================================================
# MCP (MODEL CONTEXT PROTOCOL) SETTINGS
# =============================================================================

# User Isolation for MCP Server
MCP_USER_ISOLATION=true
MCP_DEFAULT_USER=default

# =============================================================================
# SECURITY & MONITORING
# =============================================================================

# SQL Validation & Security
ENABLE_SQL_VALIDATION=true
MAX_QUERY_LENGTH=10000
ENABLE_CODE_VALIDATION=true
ENABLE_INPUT_SANITIZATION=false
MAX_FILE_UPLOAD_SIZE=10485760
SESSION_TIMEOUT=3600

# Monitoring & Health Checks
ENABLE_HEALTH_CHECKS=true
HEALTH_CHECK_INTERVAL=60
ENABLE_METRICS_EXPORT=true
METRICS_ENDPOINT=/metrics
ENABLE_TRACING=false
ENABLE_ALERTING=false

# Rate Limiting
RATE_LIMITING_ENABLED=false
REQUESTS_PER_MINUTE=60
REQUESTS_PER_HOUR=1000
BURST_LIMIT=10

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log Settings
LOG_LEVEL=INFO
LOG_FORMAT={time} | {level} | {name}:{function}:{line} - {message}
LOG_ROTATION=100 MB
LOG_RETENTION=7 days
STRUCTURED_LOGGING=false
INCLUDE_TRACE_ID=false

# =============================================================================
# FEATURE FLAGS (All enabled by default in current version)
# =============================================================================

# Component Architecture (all enabled)
USE_DATABASE_MANAGER=true
USE_SQL_GENERATION_SERVICE=true
USE_TRAINING_DATA_MANAGER=true
USE_ERROR_HANDLING_SERVICE=true
USE_V2_COMPONENTS=true

# Agent System
ENABLE_AGENTS=true
ENABLE_PARALLEL_VALIDATION=false

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Database Performance
POSTGRES_POOL_SIZE=20
POSTGRES_POOL_OVERFLOW=30
POSTGRES_POOL_PRE_PING=true

# Concurrent Processing
MAX_CONCURRENT_REQUESTS=10
BATCH_SIZE=1000

# Memory Management
ENABLE_MEMORY_OPTIMIZATION=true

# =============================================================================
# DEVELOPMENT & TESTING
# =============================================================================

# Testing Configuration
RUN_TESTS_ON_STARTUP=false
ENABLE_DEBUG_ENDPOINTS=false

# Demo & Development Mode
DEMO_MODE=false
SKIP_DATABASE_VALIDATION=false